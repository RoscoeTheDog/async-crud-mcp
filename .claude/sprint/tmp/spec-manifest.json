{
  "spec_path": "C:\\Users\\Admin\\Documents\\GitHub\\claude-code-tooling\\claude-mcp\\daemon-service",
  "spec_version": "1.15.0",
  "extracted_at": "2026-02-12T23:30:00Z",
  "target_project": {
    "app_name": "async-crud-mcp",
    "package_name": "async_crud_mcp",
    "default_port": 8422
  },
  "deliverables": [
    {
      "id": "d1",
      "path": "pyproject.toml",
      "description": "Project configuration with all required dependencies (pydantic, pydantic-settings, typer, loguru, tenacity, httpx, python-dotenv, pywin32), build system, entry points, and dev dependencies",
      "type": "config",
      "acceptance_criteria": [
        "Contains pydantic>=2.0 dependency",
        "Contains pydantic-settings>=2.0 dependency",
        "Contains typer>=0.9 dependency",
        "Contains loguru>=0.7 dependency",
        "Contains tenacity>=8.0 dependency",
        "Contains httpx>=0.24 dependency",
        "Contains python-dotenv>=1.0 dependency",
        "Contains pywin32>=306 conditional on sys_platform=='win32'",
        "Contains psutil>=5.9 in dev dependencies",
        "Entry point async-crud-mcp = async_crud_mcp.cli:app",
        "Build system configured for hatchling with src layout"
      ]
    },
    {
      "id": "d2",
      "path": "src/async_crud_mcp/__init__.py",
      "description": "Package init with __version__ as single source of truth (Design Principle 7)",
      "type": "module",
      "acceptance_criteria": [
        "Defines __version__ string as the single source of truth",
        "All other version references import from this location",
        "Contains module docstring describing the package"
      ]
    },
    {
      "id": "d3",
      "path": "src/async_crud_mcp/__main__.py",
      "description": "Module entry point for python -m async_crud_mcp execution",
      "type": "module",
      "acceptance_criteria": [
        "Allows running via python -m async_crud_mcp",
        "Delegates to CLI app() entry point"
      ]
    },
    {
      "id": "d4",
      "path": "src/async_crud_mcp/daemon/__init__.py",
      "description": "Daemon package init exposing key symbols",
      "type": "module",
      "acceptance_criteria": [
        "Package initializer for daemon subpackage",
        "Exports key daemon components"
      ]
    },
    {
      "id": "d5",
      "path": "src/async_crud_mcp/daemon/paths.py",
      "description": "Cross-platform path helpers for config, logs, data, shared, venv directories following OS conventions (Windows LOCALAPPDATA, macOS Library, Linux XDG)",
      "type": "module",
      "acceptance_criteria": [
        "APP_NAME set to 'async-crud-mcp' (ADR-009 single name convention)",
        "get_install_dir() returns platform-appropriate install path",
        "get_config_dir() returns platform-appropriate config path",
        "get_logs_dir() returns platform-appropriate logs path with ProgramData fallback for Windows service context (ADR-006)",
        "get_data_dir() returns platform-appropriate data path",
        "get_shared_dir() returns system-wide shared directory",
        "get_shared_python_dir() and get_shared_uv_dir() for installer support",
        "get_user_dir() returns per-user base directory",
        "get_venv_dir() returns per-user venv directory",
        "get_config_file_path() returns path to config.json",
        "get_user_config_file_path(username) resolves per-user config via Windows registry",
        "get_user_logs_dir(username) returns per-user log dir under ProgramData",
        "_is_windows_service_context() detects LocalSystem account",
        "_get_user_profile_path(username) resolves user profile via registry and pywin32",
        "XDG compliance on Linux (XDG_CONFIG_HOME, XDG_DATA_HOME, XDG_STATE_HOME, XDG_CACHE_HOME)",
        "No directories created automatically - callers must mkdir"
      ]
    },
    {
      "id": "d6",
      "path": "src/async_crud_mcp/daemon/bootstrap_daemon.py",
      "description": "Session-aware bootstrap daemon that manages MCP server lifecycle. Monitors user session state and config changes to start/stop MCP server subprocess",
      "type": "module",
      "acceptance_criteria": [
        "BootstrapDaemon class with running flag and mcp_process tracking",
        "configure_logging() uses loguru with enqueue=True and rotation",
        "Signal handlers wrapped in try/except ValueError for Windows service compat",
        "async run() method with main loop polling session state and config",
        "_load_settings() detects config file changes by mtime",
        "_get_python_executable() with multi-candidate search for pythonservice.exe (ADR-007)",
        "_start_mcp_server() launches subprocess with stderr redirected to file (not PIPE)",
        "_stop_mcp_server() with graceful terminate and 5s timeout then kill",
        "_cleanup_process() for proper handle cleanup",
        "await logger.complete() in finally block for loguru drain (ADR-005)",
        "Console handler only when running interactively (sys.stdout.isatty())",
        "CLI entry point via __main__ block"
      ]
    },
    {
      "id": "d7",
      "path": "src/async_crud_mcp/daemon/session_detector.py",
      "description": "Cross-platform user session detection via polling (Windows WTS API, macOS /dev/console, Linux /run/user)",
      "type": "module",
      "acceptance_criteria": [
        "get_active_sessions() returns list of lowercase usernames",
        "is_user_session_active(username) checks specific user",
        "Windows: Uses win32ts.WTSEnumerateSessions with WTSActive/WTSConnected states",
        "macOS: Uses stat -f %Su /dev/console",
        "Linux: Checks /run/user/{uid} directories for uid >= 1000",
        "Handles ImportError for pywin32 gracefully",
        "CLI test entry point via __main__"
      ]
    },
    {
      "id": "d8",
      "path": "src/async_crud_mcp/daemon/config_watcher.py",
      "description": "Config file watcher with debounce protection and last-known-good caching for resilient config loading",
      "type": "module",
      "acceptance_criteria": [
        "ConfigWatcher class with debounce_seconds parameter",
        "check_for_changes() returns True only after debounce window passes",
        "ResilientConfigLoader generic class with pydantic model validation",
        "Falls back to last-known-good config on ValidationError or JSONDecodeError",
        "_strip_comment_fields() removes _-prefixed and $-prefixed keys recursively",
        "atomic_write_config() writes via temp file and rename",
        "has_fallback property"
      ]
    },
    {
      "id": "d9",
      "path": "src/async_crud_mcp/daemon/graceful_shutdown.py",
      "description": "Cross-platform signal handling and graceful shutdown with context manager and async support",
      "type": "module",
      "acceptance_criteria": [
        "ShutdownHandler class with SIGTERM/SIGINT handling",
        "Signal registration wrapped in try/except ValueError for Windows service compat",
        "Callback registration via add_callback()",
        "Context manager support (__enter__/__exit__)",
        "graceful_stop() function with timeout and force-stop fallback",
        "shutdown_context() context manager",
        "AsyncShutdownHandler for async code",
        "SIGHUP handling on Unix"
      ]
    },
    {
      "id": "d10",
      "path": "src/async_crud_mcp/daemon/logging_setup.py",
      "description": "Loguru-based logging configuration with console and file handlers, rotation, and context binding",
      "type": "module",
      "acceptance_criteria": [
        "setup_logging() configures both console and file handlers",
        "enqueue=True on all handlers for async safety (ADR-005)",
        "Console handler with colored format (CONSOLE_FORMAT)",
        "File handler with 10 MB rotation, 7 day retention, gz compression",
        "service_mode parameter skips console when stdout unavailable",
        "serialize_file option for JSON output",
        "diagnose=False for file handler in production (security)",
        "get_logger(name) returns context-bound logger",
        "add_request_context(request_id) for request tracing",
        "No stdlib logging - loguru only"
      ]
    },
    {
      "id": "d11",
      "path": "src/async_crud_mcp/daemon/config_init.py",
      "description": "Configuration initialization with default generation, interactive prompts, service-context detection, and multi-user config resolution",
      "type": "module",
      "acceptance_criteria": [
        "DEFAULT_PORT and APP_NAME constants",
        "_is_windows_service_context() detects LocalSystem",
        "get_config_dir(username) with service context fallback to ProgramData",
        "get_config_file_path(username) returns config.json path",
        "get_logs_dir(username) with service context fallback",
        "get_user_logs_dir(username) for per-user dispatcher logs",
        "get_user_config_file_path(username) resolves via Windows registry",
        "_strip_comment_fields(data) removes _/$-prefixed keys",
        "load_settings_from_file(config_path) with merge against defaults",
        "find_available_port(start, end) scans for first available port",
        "generate_default_config() returns daemon+server config dict",
        "init_config() with force, port, host, interactive, username params",
        "Typer fallback to input() for interactive prompts"
      ]
    },
    {
      "id": "d12",
      "path": "src/async_crud_mcp/daemon/installer.py",
      "description": "Platform-agnostic installer with ABC factory pattern - InstallerBase, WindowsServiceInstaller, LaunchdInstaller (skeleton), SystemdInstaller (skeleton)",
      "type": "module",
      "acceptance_criteria": [
        "InstallerBase abstract class with install/uninstall/start/stop/status/list methods",
        "WindowsServiceInstaller using sc.exe for start/stop/status",
        "WindowsServiceInstaller.install() delegates to windows_service.install_service()",
        "LaunchdInstaller skeleton for macOS (NotImplementedError)",
        "SystemdInstaller skeleton for Linux (NotImplementedError)",
        "get_installer() factory function selecting by sys.platform",
        "SERVICE_NAME = '{APP_NAME}-daemon' (single system-wide service)",
        "APP_NAME constant using ADR-009 convention"
      ]
    },
    {
      "id": "d13",
      "path": "src/async_crud_mcp/daemon/health.py",
      "description": "Application-level health check verifying config readability, daemon enabled status, logs directory, and port connectivity (ADR-012)",
      "type": "module",
      "acceptance_criteria": [
        "_is_port_listening(host, port) TCP connectivity check",
        "check_health() returns dict with status/config_readable/daemon_enabled/logs_dir_exists/port_listening/host/port/message",
        "Status values: healthy, degraded, unhealthy",
        "Port listening check only performed when daemon is enabled",
        "Returns port_listening: None when check not applicable",
        "Includes host and port fields in result (ADR-012)"
      ]
    },
    {
      "id": "d14",
      "path": "src/async_crud_mcp/daemon/windows/__init__.py",
      "description": "Windows-specific daemon package init",
      "type": "module",
      "acceptance_criteria": [
        "Package initializer for windows subpackage"
      ]
    },
    {
      "id": "d15",
      "path": "src/async_crud_mcp/daemon/windows/bootstrap_service.py",
      "description": "Windows Service wrapper using pywin32 ServiceFramework with Multi-User Dispatcher, direct CreateService API, and WindowsSelectorEventLoopPolicy",
      "type": "module",
      "acceptance_criteria": [
        "DaemonService class extending win32serviceutil.ServiceFramework",
        "_svc_name_ = 'async-crud-mcp-daemon'",
        "GetAcceptedControls() includes SERVICE_ACCEPT_SESSIONCHANGE",
        "SvcOtherEx() handles WTS_SESSION_LOGON/LOGOFF events",
        "SvcDoRun() reports SERVICE_RUNNING immediately (BUG-01: prevents error 1053)",
        "Uses WindowsSelectorEventLoopPolicy with manual loop (ADR-011, GAP-6)",
        "SvcDoRun() wrapped in try/except with servicemanager.LogErrorMsg (BUG-07)",
        "install_service() uses direct win32service.CreateService() API (GAP-4, BUG-11)",
        "Writes PythonClass registry key for pythonservice.exe",
        "uninstall_service() function",
        "start_service() with timeout waiting for RUNNING state",
        "stop_service() function",
        "Platform check raises ImportError on non-Windows"
      ]
    },
    {
      "id": "d16",
      "path": "src/async_crud_mcp/daemon/windows/dispatcher.py",
      "description": "Multi-User Dispatcher for Windows service context managing per-user MCP server workers via CreateProcessAsUser with port conflict detection (ADR-012)",
      "type": "module",
      "acceptance_criteria": [
        "UserWorker dataclass with username, session_ids, user_token, config_path, config_mtime, profile_path, process_handle, process_id, stderr_file, started_at",
        "MultiUserDispatcher class with workers dict keyed by username",
        "_configure_logging() with GAP-8 fallback chain: ProgramData -> LocalAppData -> Temp",
        "async run() with _enumerate_existing_sessions() on startup",
        "on_session_logon(session_id) creates/updates workers",
        "on_session_logoff(session_id) removes session, stops worker on last session",
        "_create_worker() resolves paths and user token via WTSQueryUserToken",
        "_start_worker() uses CreateProcessAsUser with per-user environment block",
        "_start_worker() includes port pre-check and orphan kill (ADR-012)",
        "_stop_worker() terminates process and closes handles",
        "_stop_all_workers() on shutdown",
        "_poll_workers() checks process alive, port listening, config changes",
        "Port health check with STARTUP_GRACE_SECONDS = 15 (ADR-012)",
        "_check_port_available(host, port) returns (available, owning_pid)",
        "_is_port_listening(host, port) TCP check",
        "_find_port_owner(port) via PowerShell Get-NetTCPConnection",
        "_kill_port_owner(port, exclude_pid) via taskkill",
        "_get_python_executable() multi-candidate search (ADR-007)",
        "SYSTEM_ACCOUNTS frozenset for filtering",
        "Skips system accounts on session events",
        "await logger.complete() in finally block",
        "Platform check raises ImportError on non-Windows"
      ]
    },
    {
      "id": "d17",
      "path": "src/async_crud_mcp/daemon/windows/session_detector.py",
      "description": "Windows-specific session detection via WTS API with detailed session information",
      "type": "module",
      "acceptance_criteria": [
        "get_active_sessions() using win32ts.WTSEnumerateSessions",
        "is_user_session_active(username) case-insensitive check",
        "get_session_details(username) returns dict with session_id, state, state_code, is_active",
        "Handles WTSActive, WTSConnected, WTSDisconnected, etc. states",
        "Platform check raises ImportError on non-Windows"
      ]
    },
    {
      "id": "d18",
      "path": "src/async_crud_mcp/cli/__init__.py",
      "description": "CLI package init with main Typer app and subcommand group registration (bootstrap, daemon, config, setup, quick-install, uninstall, version)",
      "type": "module",
      "acceptance_criteria": [
        "Main typer.Typer() app with name='async-crud-mcp'",
        "bootstrap_app subcommand group for OS service lifecycle",
        "daemon_app subcommand group for MCP server control",
        "config_app subcommand group for configuration management",
        "setup command for per-user setup wizard",
        "quick-install top-level command",
        "uninstall top-level command",
        "version top-level command showing __version__",
        "no_args_is_help=True"
      ]
    },
    {
      "id": "d19",
      "path": "src/async_crud_mcp/cli/bootstrap_cmd.py",
      "description": "Bootstrap (OS service) CLI commands: install, uninstall, start, stop, status, list",
      "type": "module",
      "acceptance_criteria": [
        "install command with --force and --use-task-scheduler options",
        "uninstall command with --username and --force options",
        "start command with --username option",
        "stop command with --username option",
        "status command with --username and --json options",
        "list command showing all active per-user workers",
        "Admin privilege check and elevation for install/uninstall",
        "Uses get_installer() factory pattern"
      ]
    },
    {
      "id": "d20",
      "path": "src/async_crud_mcp/cli/daemon_cmd.py",
      "description": "Daemon (MCP server) CLI commands: start, stop, restart, status, logs - controls via config file mutations",
      "type": "module",
      "acceptance_criteria": [
        "start command sets daemon.enabled=true in config",
        "stop command sets daemon.enabled=false in config",
        "restart command cycles the enabled flag with wait",
        "status command with --username, --all, --json options",
        "logs command with --follow, --lines, --username, --user options",
        "Logs checks ProgramData path for Windows service per-user logs",
        "All commands use config file mutation (ADR-003), not direct process control"
      ]
    },
    {
      "id": "d21",
      "path": "src/async_crud_mcp/cli/config_cmd.py",
      "description": "Config CLI commands: init, show, edit, validate",
      "type": "module",
      "acceptance_criteria": [
        "init command with --force, --port, --no-interactive, --username options",
        "show command with --username and --json options",
        "edit command opens config in default editor",
        "validate command checks config file validity",
        "Uses pydantic model validation"
      ]
    },
    {
      "id": "d22",
      "path": "src/async_crud_mcp/cli/setup_cmd.py",
      "description": "Per-user setup wizard command - no admin required, creates directories, config, configures Claude Code CLI",
      "type": "module",
      "acceptance_criteria": [
        "setup command with --port, --no-interactive, --force options",
        "Step 1: Check prerequisites",
        "Step 2: Find available port (auto-discover if default in use)",
        "Step 3: Create per-user directories (config, logs)",
        "Step 4: Generate default config",
        "Step 5: Configure Claude Code CLI",
        "Step 6: Verify server connectivity",
        "No admin required"
      ]
    },
    {
      "id": "d23",
      "path": "src/async_crud_mcp/cli/install_cmd.py",
      "description": "Quick install and uninstall top-level commands for all-in-one installation",
      "type": "module",
      "acceptance_criteria": [
        "quick_install() with --force, --port, --no-start options",
        "uninstall() with --keep-config/--remove-config, --keep-logs/--remove-logs, --force options",
        "Admin check and elevation for quick-install on Windows",
        "Installs service, generates config, starts service, enables daemon",
        "Uses Rich console for output with fallback"
      ]
    },
    {
      "id": "d24",
      "path": "src/async_crud_mcp/config.py",
      "description": "Pydantic-settings based configuration with DaemonConfig, Settings, env var overrides, and from_file() class method",
      "type": "module",
      "acceptance_criteria": [
        "DaemonConfig pydantic BaseModel with enabled, host, port, transport, log_level, config_poll_seconds, session_poll_seconds, wait_for_session",
        "Settings class extending BaseSettings with env_prefix='ASYNC_CRUD_MCP_'",
        "env_nested_delimiter='__' for nested config overrides",
        "Settings.from_file(config_path) class method for per-user config loading",
        "Port validation: ge=1024, le=65535 or null",
        "Host validation: non-empty string",
        "get_settings() singleton accessor with _force_reload option",
        "_strip_comment_fields() for _/$-prefixed comment removal"
      ]
    },
    {
      "id": "d25",
      "path": "src/async_crud_mcp/server.py",
      "description": "MCP server entry point with port pre-flight check (ADR-012), health endpoint, and SSE transport",
      "type": "module",
      "acceptance_criteria": [
        "Server entry point callable via python -m async_crud_mcp.server",
        "Port pre-flight check using socket.bind() before mcp.run() (ADR-012)",
        "Exit code 48 on EADDRINUSE (port conflict)",
        "Health endpoint at /health returning status, version, uptime",
        "SSE transport on localhost by default",
        "Localhost binding security (127.0.0.1 default)",
        "Logs security warning for non-localhost binding"
      ]
    },
    {
      "id": "d26",
      "path": "scripts/setup.bat",
      "description": "Windows installer wrapper - thin shell wrapper (~40 lines) that delegates to installer.py",
      "type": "script",
      "acceptance_criteria": [
        "Thin wrapper that finds Python and runs installer.py",
        "Admin privilege check and UAC elevation",
        "Passes command-line arguments through",
        "Double-click friendly (no terminal required)",
        "Uses ONLY batch commands (no Python)"
      ]
    },
    {
      "id": "d27",
      "path": "scripts/setup.sh",
      "description": "Unix installer wrapper - thin shell wrapper that delegates to installer.py for macOS/Linux",
      "type": "script",
      "acceptance_criteria": [
        "Thin wrapper that finds Python and runs installer.py",
        "Checks for python3 or python on PATH",
        "Passes command-line arguments through",
        "Executable permissions (chmod +x)"
      ]
    },
    {
      "id": "d28",
      "path": "scripts/installer.py",
      "description": "Stdlib-only Python installer (~1100 lines) - handles install/uninstall/interactive menu, uv bootstrap, venv creation, pywin32 configuration, service installation",
      "type": "script",
      "acceptance_criteria": [
        "Uses ONLY Python stdlib (no third-party imports)",
        "Interactive menu when run without arguments (Install/Reinstall/Uninstall/Quit)",
        "install subcommand with --force, --port options",
        "uninstall subcommand with --all option",
        "Checks privileges (admin on Windows)",
        "Preflight checks (Python version >= 3.10, disk space, permissions)",
        "Locates project root via pyproject.toml",
        "Downloads and installs uv package manager with pip fallback",
        "Creates venv with uv venv --managed-python (ADR-010)",
        "Installs package via uv pip install (fallback to pip)",
        "Configures pywin32 DLLs for Windows Service (GAP-5)",
        "Installs OS service via direct CreateService API (GAP-4)",
        "Runs setup wizard and server tests",
        "Exit codes: 0=success, 1=failed, 130=cancelled"
      ]
    },
    {
      "id": "d29",
      "path": "scripts/uninstaller.py",
      "description": "Stdlib-only Python uninstaller for clean removal of the application",
      "type": "script",
      "acceptance_criteria": [
        "Uses ONLY Python stdlib",
        "Stops running service",
        "Removes service registration",
        "Optional removal of config and logs",
        "Prompt for confirmation before destructive actions"
      ]
    },
    {
      "id": "d30",
      "path": "scripts/bootstrap_uv.py",
      "description": "Cross-platform uv package manager bootstrap utility - downloads and installs uv binary",
      "type": "script",
      "acceptance_criteria": [
        "install_uv() downloads uv binary for current platform",
        "pip_install_with_uv() uses uv for package installation",
        "create_venv_with_uv() creates venv using uv",
        "Cross-platform download URLs (Windows/macOS Intel/ARM/Linux x64/ARM)",
        "Fallback to pip if uv installation fails"
      ]
    },
    {
      "id": "d31",
      "path": "scripts/build_installer.py",
      "description": "Python Embedded Bundle builder - creates standalone distribution with embedded Python, vendored dependencies, and uv",
      "type": "script",
      "acceptance_criteria": [
        "Downloads Python embeddable package",
        "Creates ._pth file for isolation",
        "Vendors all dependencies into Lib/site-packages",
        "Includes uv binary",
        "Creates launcher scripts (bin/async-crud-mcp.bat)",
        "Outputs compressed zip (~50-65 MB)"
      ]
    },
    {
      "id": "d32",
      "path": "scripts/configure_claude_code.py",
      "description": "Claude Code CLI configuration script - adds MCP server entry to Claude Code/Desktop config",
      "type": "script",
      "acceptance_criteria": [
        "Configures Claude Code CLI with MCP server SSE endpoint",
        "Reads/writes Claude Desktop config at platform-appropriate path",
        "Adds mcpServers entry with type:sse and localhost URL",
        "Handles existing config without overwriting other entries"
      ]
    },
    {
      "id": "d33",
      "path": "scripts/test_server.py",
      "description": "Post-install server verification script - validates server is functioning after installation",
      "type": "script",
      "acceptance_criteria": [
        "Checks server health endpoint",
        "Validates port connectivity",
        "--port option for custom port",
        "--skip-logs option to skip log file age check",
        "--log-age option for max log age",
        "Clear pass/fail output"
      ]
    },
    {
      "id": "d34",
      "path": "scripts/test_server.bat",
      "description": "Windows wrapper for test_server.py - double-click friendly",
      "type": "script",
      "acceptance_criteria": [
        "Thin wrapper that runs test_server.py via Python",
        "Double-click friendly"
      ]
    },
    {
      "id": "d35",
      "path": "scripts/test_server.sh",
      "description": "Unix wrapper for test_server.py - double-click friendly",
      "type": "script",
      "acceptance_criteria": [
        "Thin wrapper that runs test_server.py via Python",
        "Executable permissions"
      ]
    },
    {
      "id": "d36",
      "path": "src/async_crud_mcp/models/__init__.py",
      "description": "Models package init",
      "type": "module",
      "acceptance_criteria": [
        "Package initializer for models subpackage"
      ]
    },
    {
      "id": "d37",
      "path": "src/async_crud_mcp/models/requests.py",
      "description": "Pydantic request models for MCP tool inputs",
      "type": "module",
      "acceptance_criteria": [
        "Pydantic v2 BaseModel classes for tool request schemas",
        "Proper field validation with Field() descriptors"
      ]
    },
    {
      "id": "d38",
      "path": "src/async_crud_mcp/models/responses.py",
      "description": "Pydantic response models for MCP tool outputs",
      "type": "module",
      "acceptance_criteria": [
        "Pydantic v2 BaseModel classes for tool response schemas",
        "Consistent response structure across tools"
      ]
    },
    {
      "id": "d39",
      "path": "src/async_crud_mcp/core/__init__.py",
      "description": "Core package init",
      "type": "module",
      "acceptance_criteria": [
        "Package initializer for core subpackage"
      ]
    },
    {
      "id": "d40",
      "path": "src/async_crud_mcp/core/file_io.py",
      "description": "Async file I/O operations",
      "type": "module",
      "acceptance_criteria": [
        "Async read/write file operations",
        "Proper error handling for I/O failures"
      ]
    },
    {
      "id": "d41",
      "path": "src/async_crud_mcp/core/path_validator.py",
      "description": "Path validation and sanitization for file operations",
      "type": "module",
      "acceptance_criteria": [
        "Path validation to prevent directory traversal",
        "Path sanitization and normalization"
      ]
    },
    {
      "id": "d42",
      "path": "src/async_crud_mcp/core/lock_manager.py",
      "description": "File locking manager for concurrent access control",
      "type": "module",
      "acceptance_criteria": [
        "File-level locking for concurrent operations",
        "Lock acquisition and release"
      ]
    },
    {
      "id": "d43",
      "path": "src/async_crud_mcp/core/persistence.py",
      "description": "Persistence layer for operation state and recovery",
      "type": "module",
      "acceptance_criteria": [
        "Operation state persistence",
        "Recovery from interrupted operations"
      ]
    },
    {
      "id": "d44",
      "path": "src/async_crud_mcp/core/diff_engine.py",
      "description": "Diff engine for file update operations",
      "type": "module",
      "acceptance_criteria": [
        "Diff generation and application",
        "Support for partial file updates"
      ]
    },
    {
      "id": "d45",
      "path": "src/async_crud_mcp/core/file_watcher.py",
      "description": "File system watcher for detecting external changes",
      "type": "module",
      "acceptance_criteria": [
        "Watches file system for changes using watchdog",
        "Notifies on create/modify/delete events"
      ]
    },
    {
      "id": "d46",
      "path": "src/async_crud_mcp/tools/__init__.py",
      "description": "Tools package init with tool registration",
      "type": "module",
      "acceptance_criteria": [
        "Package initializer for tools subpackage",
        "Tool registration/discovery mechanism"
      ]
    },
    {
      "id": "d47",
      "path": "src/async_crud_mcp/tools/async_read.py",
      "description": "Async file read MCP tool",
      "type": "module",
      "acceptance_criteria": [
        "MCP tool for async file reading",
        "Proper error handling and response format"
      ]
    },
    {
      "id": "d48",
      "path": "src/async_crud_mcp/tools/async_write.py",
      "description": "Async file write MCP tool",
      "type": "module",
      "acceptance_criteria": [
        "MCP tool for async file writing",
        "Proper error handling and response format"
      ]
    },
    {
      "id": "d49",
      "path": "src/async_crud_mcp/tools/async_update.py",
      "description": "Async file update MCP tool",
      "type": "module",
      "acceptance_criteria": [
        "MCP tool for async file updating/patching",
        "Proper error handling and response format"
      ]
    },
    {
      "id": "d50",
      "path": "src/async_crud_mcp/tools/async_delete.py",
      "description": "Async file delete MCP tool",
      "type": "module",
      "acceptance_criteria": [
        "MCP tool for async file deletion",
        "Proper error handling and response format"
      ]
    },
    {
      "id": "d51",
      "path": "src/async_crud_mcp/tools/async_list.py",
      "description": "Async directory listing MCP tool",
      "type": "module",
      "acceptance_criteria": [
        "MCP tool for async directory listing",
        "Proper error handling and response format"
      ]
    },
    {
      "id": "d52",
      "path": "src/async_crud_mcp/tools/async_append.py",
      "description": "Async file append MCP tool",
      "type": "module",
      "acceptance_criteria": [
        "MCP tool for async file appending",
        "Proper error handling and response format"
      ]
    },
    {
      "id": "d53",
      "path": "src/async_crud_mcp/tools/async_rename.py",
      "description": "Async file rename MCP tool",
      "type": "module",
      "acceptance_criteria": [
        "MCP tool for async file renaming/moving",
        "Proper error handling and response format"
      ]
    },
    {
      "id": "d54",
      "path": "src/async_crud_mcp/tools/async_batch_read.py",
      "description": "Async batch file read MCP tool",
      "type": "module",
      "acceptance_criteria": [
        "MCP tool for reading multiple files in one operation",
        "Proper error handling and response format"
      ]
    },
    {
      "id": "d55",
      "path": "src/async_crud_mcp/tools/async_batch_write.py",
      "description": "Async batch file write MCP tool",
      "type": "module",
      "acceptance_criteria": [
        "MCP tool for writing multiple files in one operation",
        "Proper error handling and response format"
      ]
    },
    {
      "id": "d56",
      "path": "src/async_crud_mcp/tools/async_batch_update.py",
      "description": "Async batch file update MCP tool",
      "type": "module",
      "acceptance_criteria": [
        "MCP tool for updating multiple files in one operation",
        "Proper error handling and response format"
      ]
    },
    {
      "id": "d57",
      "path": "src/async_crud_mcp/tools/async_status.py",
      "description": "Async file status MCP tool",
      "type": "module",
      "acceptance_criteria": [
        "MCP tool for checking file status/metadata",
        "Proper error handling and response format"
      ]
    },
    {
      "id": "d58",
      "path": "tests/__init__.py",
      "description": "Tests package init",
      "type": "test",
      "acceptance_criteria": [
        "Package initializer for tests"
      ]
    },
    {
      "id": "d59",
      "path": "tests/test_config.py",
      "description": "Tests for configuration module - pydantic validation, env overrides, from_file loading",
      "type": "test",
      "acceptance_criteria": [
        "Tests DaemonConfig validation (port range, host non-empty)",
        "Tests Settings env var overrides",
        "Tests Settings.from_file() loading",
        "Tests comment field stripping",
        "Tests default config generation"
      ]
    },
    {
      "id": "d60",
      "path": "tests/test_server.py",
      "description": "Tests for server module",
      "type": "test",
      "acceptance_criteria": [
        "Tests server startup and health endpoint",
        "Tests port pre-flight check (ADR-012)"
      ]
    },
    {
      "id": "d61",
      "path": "tests/test_file_io.py",
      "description": "Tests for core file I/O operations",
      "type": "test",
      "acceptance_criteria": [
        "Tests async read/write operations",
        "Tests error handling for missing files"
      ]
    },
    {
      "id": "d62",
      "path": "tests/test_path_validator.py",
      "description": "Tests for path validation",
      "type": "test",
      "acceptance_criteria": [
        "Tests path sanitization",
        "Tests directory traversal prevention"
      ]
    },
    {
      "id": "d63",
      "path": "tests/test_lock_manager.py",
      "description": "Tests for lock manager",
      "type": "test",
      "acceptance_criteria": [
        "Tests lock acquisition and release",
        "Tests concurrent access scenarios"
      ]
    },
    {
      "id": "d64",
      "path": "tests/test_persistence.py",
      "description": "Tests for persistence layer",
      "type": "test",
      "acceptance_criteria": [
        "Tests state persistence",
        "Tests recovery scenarios"
      ]
    },
    {
      "id": "d65",
      "path": "tests/test_diff_engine.py",
      "description": "Tests for diff engine",
      "type": "test",
      "acceptance_criteria": [
        "Tests diff generation",
        "Tests diff application"
      ]
    },
    {
      "id": "d66",
      "path": "tests/test_file_watcher.py",
      "description": "Tests for file watcher",
      "type": "test",
      "acceptance_criteria": [
        "Tests change detection",
        "Tests event notification"
      ]
    },
    {
      "id": "d67",
      "path": "tests/test_tools/test_async_read.py",
      "description": "Tests for async_read tool",
      "type": "test",
      "acceptance_criteria": [
        "Tests reading existing files",
        "Tests error on missing files"
      ]
    },
    {
      "id": "d68",
      "path": "tests/test_tools/test_async_write.py",
      "description": "Tests for async_write tool",
      "type": "test",
      "acceptance_criteria": [
        "Tests writing new files",
        "Tests overwrite behavior"
      ]
    },
    {
      "id": "d69",
      "path": "tests/test_tools/test_async_update.py",
      "description": "Tests for async_update tool",
      "type": "test",
      "acceptance_criteria": [
        "Tests partial file updates",
        "Tests error handling"
      ]
    },
    {
      "id": "d70",
      "path": "tests/test_tools/test_async_delete.py",
      "description": "Tests for async_delete tool",
      "type": "test",
      "acceptance_criteria": [
        "Tests file deletion",
        "Tests error on missing files"
      ]
    },
    {
      "id": "d71",
      "path": "tests/test_tools/test_async_list.py",
      "description": "Tests for async_list tool",
      "type": "test",
      "acceptance_criteria": [
        "Tests directory listing",
        "Tests filtering and patterns"
      ]
    },
    {
      "id": "d72",
      "path": "tests/test_tools/test_async_append.py",
      "description": "Tests for async_append tool",
      "type": "test",
      "acceptance_criteria": [
        "Tests appending to existing files",
        "Tests creating new files via append"
      ]
    },
    {
      "id": "d73",
      "path": "tests/test_tools/test_async_rename.py",
      "description": "Tests for async_rename tool",
      "type": "test",
      "acceptance_criteria": [
        "Tests file renaming",
        "Tests cross-directory moves"
      ]
    },
    {
      "id": "d74",
      "path": "tests/test_tools/test_async_batch_read.py",
      "description": "Tests for async_batch_read tool",
      "type": "test",
      "acceptance_criteria": [
        "Tests batch reading multiple files",
        "Tests partial failure handling"
      ]
    },
    {
      "id": "d75",
      "path": "tests/test_tools/test_async_batch_write.py",
      "description": "Tests for async_batch_write tool",
      "type": "test",
      "acceptance_criteria": [
        "Tests batch writing multiple files",
        "Tests atomicity on failure"
      ]
    },
    {
      "id": "d76",
      "path": "tests/test_tools/test_async_batch_update.py",
      "description": "Tests for async_batch_update tool",
      "type": "test",
      "acceptance_criteria": [
        "Tests batch updating multiple files",
        "Tests partial failure handling"
      ]
    },
    {
      "id": "d77",
      "path": "tests/test_tools/test_async_status.py",
      "description": "Tests for async_status tool",
      "type": "test",
      "acceptance_criteria": [
        "Tests file status retrieval",
        "Tests error on missing files"
      ]
    },
    {
      "id": "d78",
      "path": "tests/test_cli/__init__.py",
      "description": "CLI tests package init",
      "type": "test",
      "acceptance_criteria": [
        "Package initializer for CLI tests"
      ]
    },
    {
      "id": "d79",
      "path": "tests/test_cli/test_bootstrap_cmd.py",
      "description": "Tests for bootstrap CLI commands",
      "type": "test",
      "acceptance_criteria": [
        "Tests bootstrap install command",
        "Tests bootstrap status command",
        "Tests admin privilege checking"
      ]
    },
    {
      "id": "d80",
      "path": "tests/test_cli/test_daemon_cmd.py",
      "description": "Tests for daemon CLI commands",
      "type": "test",
      "acceptance_criteria": [
        "Tests daemon start/stop/restart commands",
        "Tests daemon status with --json",
        "Tests config mutation behavior (ADR-003)"
      ]
    },
    {
      "id": "d81",
      "path": "tests/test_cli/test_config_cmd.py",
      "description": "Tests for config CLI commands",
      "type": "test",
      "acceptance_criteria": [
        "Tests config init with defaults",
        "Tests config show",
        "Tests config validate"
      ]
    },
    {
      "id": "d82",
      "path": "tests/test_cli/test_setup_cmd.py",
      "description": "Tests for setup CLI command",
      "type": "test",
      "acceptance_criteria": [
        "Tests setup wizard flow",
        "Tests --no-interactive mode",
        "Tests port discovery"
      ]
    },
    {
      "id": "d83",
      "path": "tests/test_cli/test_install_cmd.py",
      "description": "Tests for quick-install and uninstall commands",
      "type": "test",
      "acceptance_criteria": [
        "Tests quick-install flow",
        "Tests uninstall with --keep-config/--remove-config"
      ]
    },
    {
      "id": "d84",
      "path": "tests/test_tools/__init__.py",
      "description": "Tools tests package init",
      "type": "test",
      "acceptance_criteria": [
        "Package initializer for tools tests"
      ]
    },
    {
      "id": "d85",
      "path": ".gitignore",
      "description": "Git ignore file with Python, venv, and build artifact patterns",
      "type": "config",
      "acceptance_criteria": [
        "Ignores __pycache__/, .ruff_cache/",
        "Ignores .venv/, venv/, dist/, build/",
        "Ignores *.egg-info/",
        "Ignores .env files",
        "Ignores .serena/, .claude-context/"
      ]
    },
    {
      "id": "d86",
      "path": "LICENSE",
      "description": "MIT license file",
      "type": "doc",
      "acceptance_criteria": [
        "Contains MIT license text"
      ]
    },
    {
      "id": "d87",
      "path": "README.md",
      "description": "Project README with installation instructions, usage examples, and architecture overview",
      "type": "doc",
      "acceptance_criteria": [
        "Project description and purpose",
        "Installation instructions (quick install, setup.bat/setup.sh)",
        "Usage examples for CLI commands",
        "Architecture overview with two-layer design"
      ]
    }
  ]
}