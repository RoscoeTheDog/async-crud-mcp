{
  "story_id": "12",
  "phase": "a",
  "status": "passed",
  "completed_at": "2026-02-13T09:00:00Z",
  "planning_output": {
    "implementation_plan": "Story 12 addresses two gaps in config_init.py relative to the PRD spec:\n\n1. **session_poll_seconds missing from generate_default_config()**: The PRD spec (section 13.1) shows the daemon config dict includes `session_poll_seconds: 3`. The pydantic model in config.py already has this field (line 55), but config_init.py's generate_default_config() does not produce it. This means configs generated by init_config or the setup wizard lack session_poll_seconds, forcing reliance on pydantic defaults when loaded later.\n\n2. **DEFAULT_PORT alignment**: The PRD placeholder table (line 83) confirms `[DEFAULT_PORT] = 8720`. The current config_init.py already uses `DEFAULT_PORT = 8720` (line 35), so this is already aligned. No change needed for AC-12.2.\n\nAdditional minor issue noted in the story description: init_config already accepts a `host` parameter and passes it through to generate_default_config (line 369: `host=host or \"127.0.0.1\"`), so the host passthrough is already present.\n\nThe main change is adding `session_poll_seconds` as a parameter to generate_default_config() and including it in the returned dict.",
    "files_to_modify": [
      "src/async_crud_mcp/daemon/config_init.py",
      "tests/test_cli/test_config_cmd.py"
    ],
    "estimated_complexity": "low",
    "ac_breakdown": {
      "AC-12.1": "Add `session_poll_seconds: int = 3` parameter to generate_default_config() function signature (after wait_for_session). Add `\"session_poll_seconds\": session_poll_seconds` to the returned daemon dict, between config_poll_seconds and wait_for_session. This aligns the generated config with the PRD spec section 13.1 which shows session_poll_seconds=3 in the daemon config. No changes needed to init_config() since it uses **kwargs passthrough via generate_default_config() -- callers who don't specify session_poll_seconds will get the default value of 3.",
      "AC-12.2": "DEFAULT_PORT is already 8720 in config_init.py line 35, matching the PRD placeholder table (line 83: `[DEFAULT_PORT] = 8720`). The PRD consistently uses 8720 throughout (lines 138, 580, 1070, 1130, 1306, 1342, 1349, 1351). No change needed -- verify and confirm alignment in tests."
    },
    "testing_strategy": "1. Add a unit test for generate_default_config() that asserts session_poll_seconds is present in the returned dict with default value 3.\n2. Add a test that calls generate_default_config(session_poll_seconds=5) and verifies the custom value is used.\n3. Verify DEFAULT_PORT == 8720 in a simple assertion test.\n4. Existing tests for init_config and config_cmd should continue to pass since the new parameter has a default value.",
    "dependencies": [
      "Story 8 (config.py port validation) - already implemented in config.py; DaemonConfig already has session_poll_seconds field"
    ]
  }
}
